<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Global Call for Solutions — UNGA Dashboard</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌍</text></svg>">
  
  <!-- External Libraries -->
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
  
  <!-- Custom Styles -->
  <link href="styles.css" rel="stylesheet">
</head>

<body>
  <header>
    <div class="header-inner">
      <div class="branding">
        <img src="logo.png" alt="Logo" />
        <div>
          <h1>Global Call for Solutions — Analytics</h1>
          <div class="subtitle">UNGA Showcase · New York · Sep 2025</div>
        </div>
      </div>
      
      <div class="actions">
        <button id="toggleTheme" class="btn secondary" title="Toggle Theme" style="margin-right: 10px;">
          🌙
        </button>
        <button id="toggleKiosk" class="btn secondary" title="Show filter controls">
          Show Controls
        </button>
      </div>
    </div>
    
    <div class="controls" id="controls">
      <label>
        🌍 Region
        <select id="fRegion" multiple></select>
      </label>
      <label>
        🏳️ Country
        <select id="fCountry" multiple></select>
      </label>
      <label>
        🏢 Organization Type
        <select id="fOrg" multiple></select>
      </label>
      <label>
        📈 Maturity Stage
        <select id="fMaturity" multiple></select>
      </label>
      <label>
        🎯 SDG Focus
        <select id="fSDG" multiple></select>
      </label>
      <div style="display: flex; gap: 10px; align-items: end">
        <button id="clear" class="btn secondary">🗑️ Clear</button>
      </div>
    </div>
  </header>

  <!-- KPI Hero Section -->
  <section class="kpis" id="kpis">
    <!-- KPI cards will be populated by JavaScript -->
  </section>

  <!-- Main Content Grid -->
  <section class="grid">
    <!-- Map Card -->
    <div class="card full">
      <div class="head">
        <div class="title">🗺️ Submissions by Country</div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <span class="legend-badge">Global overview</span>
          <button id="toggleMapView" class="btn secondary" title="Toggle between 2D and 3D view">
            🌍 2D
          </button>
        </div>
      </div>
      <div class="body">
        <div id="map" style="height: 540px"></div>
      </div>
    </div>

    <!-- SDG Stack Card -->
    <div class="card">
      <div class="head">
        <div class="title">🌱 SDGs Addressed</div>
      </div>
      <div class="body">
        <div id="sdgStack" style="height: 380px"></div>
      </div>
    </div>

    <!-- Score Distribution Card -->
    <div class="card">
      <div class="head">
        <div class="title">📊 Score Distribution</div>
      </div>
      <div class="body">
        <div id="scoreHist" style="height: 380px"></div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    Data refreshes from <code>data.json</code>.
  </footer>
  
  <!-- Mapbox Token Notice -->
  <div id="mapbox-note" style="display: none; text-align: center; padding: 20px; color: var(--muted);">
    <p>⚠️ Mapbox access token required. Update CONFIG.MAPBOX_TOKEN in the code.</p>
    <p>
      Get a free token at 
      <a href="https://account.mapbox.com/" target="_blank" style="color: var(--brand);">
        https://account.mapbox.com/
      </a>
    </p>
  </div>

  <!-- Scripts -->
  <script src="iso3-map.js"></script>
  <script src="app.js"></script>
  </body>
</html>